/**
 * jquery.dynamicDropdown.min.js
 * @author Sean "Kovik" Smith <kovik@koviko.net>
 */
(function($){$.dynamicDropdown={escapeQuotes:function(str){return str.replace(/([""\\])/g,"\\$1")},buildSelectDropdown:function(options){var select=$(document.createElement("select"));var option=null;for(var i in options){option=$(document.createElement("option")).val($.isArray(options[i])?i:options[i]).html(i).appendTo(select)}return select}};$.fn.dynamicDropdown=function(options){var settings={delimiter:" Â» ",className:"dynamic-dropdown"};$.extend(settings,options);return $(this).each(function(){var mainDropdown=$(this);var initialPosition=[];var data=[];var selectElements=[];var prepareDropdown=function(dropdown,sibling,level,position){return $(dropdown).addClass(settings.className).data("level",level).data("position",position).insertAfter(sibling).each(buildDynamicDropdown).change(buildDynamicDropdown)};var initializeDynamicDropdown=function(){var level=$(this).data("level")+1;var position="";for(var i=0;i<level;i++){position+='["'+initialPosition[i]+'"]'}var selectionOptions=eval("data"+position);if($.isArray(selectionOptions)){selectElements.push($.dynamicDropdown.buildSelectDropdown(selectionOptions));$(this).val(initialPosition[level-1]);prepareDropdown(selectElements[selectElements.length-1],this,level,position)}return $(this)};var buildDynamicDropdown=function(){var level=$(this).data("level")+1;var position=$(this).data("position")+'["'+$.dynamicDropdown.escapeQuotes($(this).val())+'"]';var selectionOptions=eval("data"+position);for(var i=selectElements.length;i>level;i--){selectElements.pop().remove()}if(selectionOptions){selectElements.push($.dynamicDropdown.buildSelectDropdown(selectionOptions));prepareDropdown(selectElements[selectElements.length-1],this,level,position)}else{mainDropdown.val($(this).val())}return $(this)};mainDropdown.children().each(function(){var parts=$(this).html().split(settings.delimiter);var name="data";var value=null;if($(this).is(":selected")){initialPosition=parts}for(var i in parts){name+='["'+$.dynamicDropdown.escapeQuotes(parts[i])+'"]';value=eval(name);if(!value){eval(name+" = [];")}else{if(!$.isArray(value)){eval(name+" = ["+eval(name)+"];")}}}eval(name+' = "'+$(this).val()+'";')});selectElements[0]=$.dynamicDropdown.buildSelectDropdown(data);$(selectElements[0]).addClass(settings.className).data("level",0).data("position","").insertAfter(this).each(initializeDynamicDropdown).change(buildDynamicDropdown)}).hide()}})(jQuery);